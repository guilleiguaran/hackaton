(function(){return function(factory){if(typeof exports=="object"){module.exports=module.exports=factory.call(this,require)}else if(typeof define=="function"&&define.amd){define(["require","underscore","backbone","knockout","knockback"],factory)}else{this.kb=factory.call(this,typeof require!=="undefined"?require:undefined)}}(function(require){var kb,ko,_,_publishMethods,_unwrapObservable;kb=this.kb||require("knockback");_=kb._;ko=kb.ko;_unwrapObservable=ko.utils.unwrapObservable;_publishMethods=kb._publishMethods;kb.DefaultObservable=function(){function DefaultObservable(target_observable,dv){var observable;this.dv=dv;observable=kb.utils.wrappedObservable(this,ko.dependentObservable({read:function(_this){return function(){var current_target;if(current_target=_unwrapObservable(target_observable())){return current_target}else{return _unwrapObservable(_this.dv)}}}(this),write:function(value){return target_observable(value)}}));_publishMethods(observable,this,["destroy","setToDefault"]);return observable}DefaultObservable.prototype.destroy=function(){return kb.utils.wrappedDestroy(this)};DefaultObservable.prototype.setToDefault=function(){return kb.utils.wrappedObservable(this)(this.dv)};return DefaultObservable}();kb.defaultObservable=function(target,default_value){return new kb.DefaultObservable(target,default_value)};kb.Observable.prototype.setToDefault=function(){var _ref;if((_ref=this.__kb_value)!=null){if(typeof _ref.setToDefault==="function"){_ref.setToDefault()}}};kb.ViewModel.prototype.setToDefault=function(){var vm_key,_ref;for(vm_key in this.__kb.vm_keys){if((_ref=this[vm_key])!=null){if(typeof _ref.setToDefault==="function"){_ref.setToDefault()}}}};kb.utils.setToDefault=function(obj){var key,value;if(!obj){return}if(ko.isObservable(obj)){if(typeof obj.setToDefault==="function"){obj.setToDefault()}}else if(_.isObject(obj)){for(key in obj){value=obj[key];if(value&&(ko.isObservable(value)||typeof value!=="function")&&(key[0]!=="_"||key.search("__kb"))){this.setToDefault(value)}}}return obj};return kb})}).call(this);